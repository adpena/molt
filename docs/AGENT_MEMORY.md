# Agent Memory Log

This log is append-only. Record coordination notes, active scope, tests, and
benchmarks here to avoid collisions during parallel work.

## Entries
- 2026-01-12T23:54:58Z codex: created memory log; pending update after k6 install
  and demo bench rerun.
- 2026-01-13T00:04:53Z codex: added coordination guidance in `AGENTS.md` and
  `GEMINI.md` to require reading `docs/AGENT_LOCKS.md` + `docs/AGENT_MEMORY.md`;
  installed k6 via Homebrew; ran demo bench with a temp venv for Django but the
  offload run failed with 503s (worker unavailable; connection reset). Tests:
  `cargo test -p molt-worker` (pass), `uv run --python 3.12 python3 -m pytest
  tests/test_molt_accel_contracts.py tests/test_django_demo.py` (pass).
- 2026-01-13T00:16:34Z codex: added `client_mode` control (shared vs per_request)
  to `molt_offload`, plus shared-client caching and per-request cleanup; updated
  `docs/spec/0912_MOLT_ACCEL_DJANGO_DECORATOR_SPEC.md`. Added a worker preflight
  check + default `MOLT_ACCEL_CLIENT_MODE=shared` in
  `bench/scripts/run_stack.sh`. Fixed worker msgpack payload encoding by using
  `ByteBuf` in `ResponseEnvelope` to avoid list payloads. Manual probe to
  `/offload/` initially returned Django 500 (TypeError on msgpack decode); after
  rebuilding the worker it returned 200 with JSON payload. Tests: `cargo test -p
  molt-worker` (pass). Bench: `PATH=/tmp/molt_bench_venv/bin:$PATH bash
  bench/scripts/run_stack.sh` (pass; baseline/offload/offload_table errors 0%).
- 2026-01-13T00:24:22Z codex: added `demo` dependency group (Django+msgpack),
  updated `bench/scripts/run_stack.sh` to prefer `uv run --project` and run
  Django from repo root, and documented uv-based demo setup in
  `docs/demo/DJANGO_OFFLOAD_QUICKSTART.md`. Updated `uv.lock` via
  `uv lock --python 3.12` and synced demo deps with `uv sync --group demo
  --python 3.12`. Bench: `MOLT_ACCEL_CLIENT_MODE=per_request bash
  bench/scripts/run_stack.sh` (pass; baseline=105.2 req/s, offload=98.1 req/s,
  offload_table=46.8 req/s, errors 0%).
- 2026-01-13T00:27:26Z codex: added optional `uv sync` step to
  `bench/scripts/run_stack.sh` (disable with `MOLT_UV_SYNC=0`) and reran the
  per-request bench with the updated script. Bench:
  `MOLT_ACCEL_CLIENT_MODE=per_request bash bench/scripts/run_stack.sh`
  (pass; baseline=105.3 req/s, offload=98.7 req/s, offload_table=46.8 req/s,
  errors 0%).
- 2026-01-13T00:33:11Z codex: ran follow-up benches for shared and per_request
  modes. Shared: `MOLT_ACCEL_CLIENT_MODE=shared bash bench/scripts/run_stack.sh`
  (pass; baseline=105.3 req/s, offload=103.5 req/s, offload_table=51.9 req/s,
  errors 0%). Per-request with sync disabled: `MOLT_UV_SYNC=0
  MOLT_ACCEL_CLIENT_MODE=per_request bash bench/scripts/run_stack.sh` (pass;
  baseline=104.9 req/s, offload=98.3 req/s, offload_table=46.8 req/s, errors
  0%).
- 2026-01-13T01:04:29Z codex (git 05ff17b73ed99360af4081408e1c4da082500441):
  blocked on missing `references/docs.md` required by proceed workflow; no
  changes or tests run.
- 2026-01-13T01:07:47Z codex: added recursion-limit runtime exports + sys wiring, len(__len__) parity, and sum/min/max builtins; updated wasm/WIT bindings and type coverage/status docs; added differential tests for reductions, len, and recursion limits. Tests: not run (not requested).
- 2026-01-13T01:34:12Z codex: expanded bytes/bytearray encoding support to utf-16/utf-32 variants with error-handler parity for ascii/latin-1, added encoding differential coverage, and updated STATUS/0014 matrix. Tests: not run (not requested).
- 2026-01-13T01:36:19Z codex (git 05ff17b73ed99360af4081408e1c4da082500441):
  added `references/docs.md` with the Django demo spec list required by the
  proceed workflow. Tests: not run (doc-only).
- 2026-01-13T02:06:00Z codex (git 05ff17b73ed99360af4081408e1c4da082500441):
  added gunicorn/uvicorn keep-alive flags in `bench/scripts/run_stack.sh`,
  documented `MOLT_SERVER_KEEPALIVE`, and fixed k6 summary parsing by setting
  `K6_SUMMARY_TREND_STATS` + handling trend stats in `run_demo_bench.py`.
  Bench runs (K6_TARGET=5 K6_SLEEP_MS=50 due to local port exhaustion at higher
  targets): gunicorn shared (baseline=72.0 req/s, offload=70.8 req/s,
  offload_table=70.5 req/s), gunicorn per_request (baseline=71.7 req/s,
  offload=64.8 req/s, offload_table=65.1 req/s), uvicorn shared
  (baseline=69.1 req/s, offload=70.0 req/s, offload_table=69.5 req/s), uvicorn
  per_request (baseline=70.1 req/s, offload=62.8 req/s, offload_table=62.6
  req/s). Tests: `cargo test -p molt-worker` (pass), `uv run --python 3.12
  python3 -m pytest tests/test_molt_accel_contracts.py tests/test_django_demo.py`
  (pass).
- 2026-01-13T02:41:38Z codex (git 05ff17b73ed99360af4081408e1c4da082500441):
  switched gunicorn bench runs to `gthread` with default threads=2, set default
  server workers to min(4, CPU cores), and defaulted k6 log level to `error` in
  `run_demo_bench.py`. Bench runs (K6_TARGET=100, K6_LOG_LEVEL=error, default
  worker counts): gunicorn shared (baseline=5830.2 req/s, offload=4076.9 req/s,
  offload_table=4420.8 req/s), gunicorn per_request (baseline=1948.5 req/s,
  offload=1541.7 req/s, offload_table=1724.1 req/s), uvicorn shared
  (baseline=4178.8 req/s, offload=2795.9 req/s, offload_table=3045.4 req/s),
  uvicorn per_request (baseline=1990.4 req/s, offload=1498.1 req/s,
  offload_table=1710.6 req/s). Tests: not run (bench-only).
- 2026-01-13T03:01:17Z codex (git 05ff17b73ed99360af4081408e1c4da082500441):
  ran longer steady-state benches (K6_STEADY=60s, K6_TARGET=100,
  K6_LOG_LEVEL=error) to stabilize p99/p999. Gunicorn shared (baseline=1943.9
  req/s, offload=1532.1 req/s, offload_table=1714.2 req/s), gunicorn per_request
  (baseline=2105.1 req/s, offload=1536.7 req/s, offload_table=1711.3 req/s),
  uvicorn shared (baseline=2014.2 req/s, offload=1535.2 req/s, offload_table=1707.0
  req/s), uvicorn per_request (baseline=2031.9 req/s, offload=1527.9 req/s,
  offload_table=1664.8 req/s). Tests: not run (bench-only).
- 2026-01-13T01:42:19Z codex: added abs/divmod builtins with numeric semantics and __abs__ fallback, wired WIT/wasm/builtins, added differential coverage, and updated STATUS/0014 matrix. Tests: not run (not requested).
- 2026-01-13T01:53:27Z codex (git 05ff17b73ed99360af4081408e1c4da082500441; dirty): implemented `ascii`/`bin`/`oct`/`hex` builtins with `__index__` fallback, wired builtins module + WIT/wasm imports/table entries, added differential coverage, and updated STATUS/0014 type matrix. Tests: not run (not requested).
- 2026-01-13T03:19:55Z codex (git 05ff17b73ed99360af4081408e1c4da082500441; dirty): tightened chr/ord + dict update error parity, added recursion guard helpers across native/wasm call paths (sys recursionlimit now uses runtime), updated wasm harness + WIT, and refreshed differential coverage. Tests: `tools/dev.py lint`, `tools/dev.py test`, `cargo clippy -- -D warnings`, `cargo test`, `uv run --python 3.14 python3 tools/bench.py --json-out bench/results/bench.json`, `uv run --python 3.14 python3 tools/bench_wasm.py --json-out bench/results/bench_wasm.json`.
- 2026-01-13T03:27:32Z codex (git 2ca92962c4289eda3495783be30ca7c5b388a666; dirty): fixed CI demo k6 failures by installing k6 in `.github/workflows/ci.yml` and `.github/workflows/perf_demo.yml`. Tests: not run (workflow-only change).
- 2026-01-13T03:56:12Z codex (git 0ff8a23160685b65d10e8d28c361d5deef0ed41b; dirty): added `sorted` builtin (runtime + wasm imports/WIT + frontend allowlist + builtins module) and expanded ordering comparisons for str/bytes/bytearray/list/tuple, updated min/max to use general ordering, implemented lambda lowering with closures/defaults/varargs/kw-only, added differential tests for sorted/lambda, and updated STATUS/0014/ROADMAP. Noted unexpected local modifications in `bench/scripts/run_demo_bench.py`, `docs/demo/DJANGO_OFFLOAD_QUICKSTART.md`, and `docs/spec/0914_BENCH_RUNNER_AND_RESULTS_FORMAT.md` that were not part of this change set.
- 2026-01-13T04:11:17Z codex (git 0ff8a23160685b65d10e8d28c361d5deef0ed41b; dirty):
  improved demo bench CPU/RSS capture by sampling listen PIDs via `lsof` and
  recording `process_context`, added gunicorn pid file handling in
  `bench/scripts/run_stack.sh`, and updated
  `docs/demo/DJANGO_OFFLOAD_QUICKSTART.md` +
  `docs/spec/0914_BENCH_RUNNER_AND_RESULTS_FORMAT.md`. Bench:
  `K6_STEADY=60s MOLT_SERVER=gunicorn bench/scripts/run_stack.sh` (baseline=2041.8
  req/s p99=67.4ms p999=72.2ms; offload=1514.6 req/s p99=98.9ms p999=107.7ms;
  offload_table=1768.6 req/s p99=45.4ms p999=48.2ms; errors 0%). Process
  metrics captured for server/worker in `bench/results/demo_k6_20260113T041023.json`.
- 2026-01-13T04:27:25Z codex (git 0ff8a23160685b65d10e8d28c361d5deef0ed41b; dirty):
  ran steady-state benches for per_request and uvicorn modes.
  Per-request (gunicorn): `K6_STEADY=60s MOLT_SERVER=gunicorn MOLT_ACCEL_CLIENT_MODE=per_request bench/scripts/run_stack.sh`
  (baseline=2019.9 req/s p99=69.4ms p999=79.8ms; offload=1543.8 req/s p99=93.0ms p999=99.3ms;
  offload_table=1766.4 req/s p99=45.0ms p999=47.8ms; errors 0%). Artifact:
  `bench/results/demo_k6_20260113T042238.json`.
  Uvicorn shared: `K6_STEADY=60s MOLT_SERVER=uvicorn MOLT_ACCEL_CLIENT_MODE=shared bench/scripts/run_stack.sh`
  (baseline=2073.3 req/s p99=67.6ms p999=81.2ms; offload=1553.1 req/s p99=91.5ms p999=95.8ms;
  offload_table=1781.3 req/s p99=44.8ms p999=47.9ms; errors 0%). Artifact:
  `bench/results/demo_k6_20260113T042647.json`.
- 2026-01-13T05:05:27Z codex (git 0ff8a23160685b65d10e8d28c361d5deef0ed41b; dirty):
  ran steady-state benches for uvicorn per_request and gunicorn K6_TARGET sweep.
  Uvicorn per_request: `K6_STEADY=60s MOLT_SERVER=uvicorn MOLT_ACCEL_CLIENT_MODE=per_request bench/scripts/run_stack.sh`
  (baseline=2035.7 req/s p99=68.2ms p999=82.4ms; offload=1541.7 req/s p99=91.7ms p999=95.3ms;
  offload_table=1783.6 req/s p99=44.6ms p999=47.5ms; errors 0%). Artifact:
  `bench/results/demo_k6_20260113T045205.json`.
  Gunicorn shared sweep (K6_STEADY=60s):
  - K6_TARGET=50: baseline=2141.7 req/s p99=37.6ms p999=41.8ms; offload=1581.4 req/s p99=47.8ms p999=55.9ms;
    offload_table=1775.4 req/s p99=44.7ms p999=48.9ms. Artifact: `bench/results/demo_k6_20260113T045628.json`.
  - K6_TARGET=100: baseline=2038.4 req/s p99=69.4ms p999=73.8ms; offload=1544.0 req/s p99=92.8ms p999=110.2ms;
    offload_table=1732.2 req/s p99=84.8ms p999=101.1ms. Artifact: `bench/results/demo_k6_20260113T050033.json`.
  - K6_TARGET=200: baseline=1904.3 req/s p99=127.5ms p999=139.1ms; offload=1493.3 req/s p99=162.1ms p999=175.7ms;
    offload_table=1650.1 req/s p99=149.0ms p999=184.5ms. Artifact: `bench/results/demo_k6_20260113T050438.json`.
- 2026-01-13T05:22:41Z codex (git 0ff8a23160685b65d10e8d28c361d5deef0ed41b; dirty):
  fixed boxed-local function calls to apply defaults via guarded direct calls;
  added explicit unsupported errors for list/set/dict/generator comprehensions;
  adjusted list.sort differential to avoid list comprehension; updated README
  perf summary and STATUS limitations. Ran `tools/dev.py test`, `tools/dev.py lint`,
  `cargo test`, `cargo clippy -- -D warnings`, `uv run --python 3.14 python3 tools/bench.py --json-out bench/results/bench.json`,
  and `uv run --python 3.14 python3 tools/bench_wasm.py --json-out bench/results/bench_wasm.json`.
- 2026-01-13T05:37:58Z codex (git 519c2e510db7126ccb92c3205a1f5f90845c05eb; dirty):
  ran uvicorn per_request steady-state sweep (K6_STEADY=60s).
  - K6_TARGET=50: baseline=2094.8 req/s p99=39.5ms p999=43.9ms; offload=1574.0 req/s p99=48.4ms p999=52.2ms;
    offload_table=1760.8 req/s p99=45.3ms p999=48.2ms. Artifact: `bench/results/demo_k6_20260113T052829.json`.
  - K6_TARGET=100: baseline=1972.6 req/s p99=72.7ms p999=90.7ms; offload=1616.1 req/s p99=88.3ms p999=95.0ms;
    offload_table=1832.9 req/s p99=79.3ms p999=83.9ms. Artifact: `bench/results/demo_k6_20260113T053233.json`.
  - K6_TARGET=200: baseline=2001.1 req/s p99=119.6ms p999=122.9ms; offload=1569.6 req/s p99=154.0ms p999=183.5ms;
    offload_table=1752.3 req/s p99=138.8ms p999=144.0ms. Artifact: `bench/results/demo_k6_20260113T053637.json`.
- 2026-01-13T06:02:44Z codex (git 519c2e510db7126ccb92c3205a1f5f90845c05eb; dirty): generated sweep summary  comparing gunicorn shared vs uvicorn per_request K6_TARGET=50/100/200 (K6_STEADY=60s). No doc updates needed; no tests run.
- 2026-01-13T06:03:01Z codex (git 519c2e510db7126ccb92c3205a1f5f90845c05eb; dirty): generated sweep summary `bench/results/demo_k6_sweep_20260113.md` comparing gunicorn shared vs uvicorn per_request K6_TARGET=50/100/200 (K6_STEADY=60s). No doc updates needed; no tests run.
- 2026-01-13T06:07:42Z codex: starting proceed workflow for Django accel/offload demos; will inspect demo/molt_accel/molt-worker/bench scaffolding and update plan/spec/docs/tests as needed.
- 2026-01-13T06:21:31Z codex: added cancel-aware DB pool acquisition and worker integration, fake DB decode-cost env var parity in Django baseline, enriched demo bench metadata/payload bytes, updated specs/roadmap/quickstart. Tests: not run.
- 2026-01-13T06:27:27Z codex: ran tests/bench after Django offload updates. Tests: cargo test -p molt-db; cargo test -p molt-worker; uv run --python 3.12 python3 -m pytest tests/test_django_demo.py. Bench: bench/scripts/run_stack.sh (baseline=2042.6 req/s, offload=1532.1 req/s, offload_table=1808.6 req/s, errors 0%). Artifacts: bench/results/demo_k6_20260113T062712.json, bench/results/demo_k6_20260113T062712.md.
- 2026-01-13T06:36:13Z codex: starting optimization+functionality push for molt_accel/molt_offload concurrency and throughput; will focus on src/molt_accel, demo bench, and relevant specs.
- 2026-01-13T07:01:54Z codex (git 519c2e510db7126ccb92c3205a1f5f90845c05eb; dirty): fixed generator resume SSA by reloading index in async index loops, added lambda positional-only differential coverage, refactored molt-worker request handling to reduce arg counts + clippy, tightened molt_not_implemented return, and removed unused exception binding in molt_accel client. Tests: `tools/dev.py lint`, `tools/dev.py test`, `cargo test`, `cargo clippy -- -D warnings`. Bench: `uv run --python 3.14 python3 tools/bench.py --json-out bench/results/bench.json`, `uv run --python 3.14 python3 tools/bench_wasm.py --json-out bench/results/bench_wasm.json`.
- 2026-01-13T07:12:08Z codex: resuming proceed workflow to add molt_accel worker pooling + decorator env selection, worker env tuning for threads/queue, and update demo/spec/tests.
- 2026-01-13T07:18:32Z codex (git 3ade558198cb5da0dba2dac3b8393823e2eb4fa5; dirty): added MoltClientPool + shared pooling via MOLT_ACCEL_POOL_SIZE, worker env tuning (MOLT_WORKER_THREADS/MOLT_WORKER_MAX_QUEUE), updated bench metadata and demo/spec docs. Tests: `uv run --python 3.12 python3 -m pytest tests/test_molt_accel_client.py tests/test_molt_accel_decorator.py`, `cargo test -p molt-worker`. Bench: not run.
- 2026-01-13T07:23:36Z codex (git 3ade558198cb5da0dba2dac3b8393823e2eb4fa5; dirty): ran demo bench with pooling/tuning: `MOLT_ACCEL_POOL_SIZE=2 MOLT_WORKER_THREADS=8 bench/scripts/run_stack.sh`. Results: baseline=2051.4 req/s p99=67.9ms p999=71.7ms; offload=1568.9 req/s p99=93.4ms p999=114.0ms; offload_table=1821.6 req/s p99=43.2ms p999=45.3ms; errors 0%. Artifacts: `bench/results/demo_k6_20260113T072233.json`, `bench/results/demo_k6_20260113T072233.md`.
- 2026-01-13T07:59:02Z codex (git 3ade558198cb5da0dba2dac3b8393823e2eb4fa5; dirty): added microsecond worker metrics and bench aggregation, refactored `molt-db` into pool/sqlite modules, wired SQLite DB mode into molt-worker + Django baseline with seeding helper, and documented native-only DB support. Tests: `cargo test -p molt-db`, `cargo test -p molt-worker`, `uv run --python 3.12 python3 -m pytest tests/test_molt_accel_client.py tests/test_molt_accel_decorator.py tests/test_django_demo.py`. Bench sweeps (`MOLT_WORKER_THREADS=8`): pool=1 baseline=2151.1 req/s p99=63.5ms p999=69.0ms; offload=1570.3 req/s p99=88.3ms p999=104.2ms; offload_table=1812.4 req/s p99=43.5ms p999=48.5ms (artifact `bench/results/demo_k6_20260113T075249.json`). pool=2 baseline=2078.4 req/s p99=66.3ms p999=72.9ms; offload=1582.3 req/s p99=88.5ms p999=104.8ms; offload_table=1796.7 req/s p99=43.6ms p999=48.4ms (artifact `bench/results/demo_k6_20260113T075512.json`). pool=4 baseline=2060.9 req/s p99=68.5ms p999=76.2ms; offload=1411.7 req/s p99=105.9ms p999=111.6ms; offload_table=1573.8 req/s p99=51.4ms p999=71.8ms (artifact `bench/results/demo_k6_20260113T075721.json`).
- 2026-01-13T07:17:23Z codex (git 3ade558198cb5da0dba2dac3b8393823e2eb4fa5; dirty): fixed CI rustfmt failure via `cargo fmt` on `runtime/molt-worker/src/main.rs`, pushed follow-up commit, and confirmed CI green for run 20947959819. Note: working tree now has uncommitted `molt_accel` + related test changes (MoltClientPool, decorator wiring) awaiting user direction.
- 2026-01-13T08:13:45Z codex (git 3ade558198cb5da0dba2dac3b8393823e2eb4fa5; dirty): implemented iterator parity cluster (iter(callable, sentinel), map/filter/zip/reversed) across runtime/frontend/wasm harness; added builtin iterator differential coverage; updated type/status matrices; fixed clippy in molt-db/molt-worker; ran full lint/test/bench. Tests: `tools/dev.py lint`, `tools/dev.py test`, `cargo test`, `cargo clippy -- -D warnings`. Bench: `uv run --python 3.14 python3 tools/bench.py --json-out bench/results/bench.json`, `uv run --python 3.14 python3 tools/bench_wasm.py --json-out bench/results/bench_wasm.json`.
- 2026-01-13T08:19:09Z codex (git 3ade558198cb5da0dba2dac3b8393823e2eb4fa5; dirty): added DB IPC contract spec `docs/spec/0915_MOLT_DB_IPC_CONTRACT.md`, scaffolded `molt_django_adapter` payload builder + tests, and updated README/ROADMAP/STATUS plus DB specs for cross-framework adapter + async Postgres priority. Added SQLite baseline test in `tests/test_django_demo.py`. Tests: `uv run --python 3.12 python3 -m pytest tests/test_molt_django_adapter_contracts.py tests/test_django_demo.py`. Bench: `MOLT_DEMO_DB_PATH=$(mktemp ...) MOLT_WORKER_THREADS=8 bench/scripts/run_stack.sh` (baseline=2033.9 req/s p99=68.3ms p999=73.5ms; offload=1577.6 req/s p99=91.1ms p999=101.0ms; offload_table=1789.9 req/s p99=43.6ms p999=45.9ms; errors 0%). Artifacts: `bench/results/demo_k6_20260113T081809.json`, `bench/results/demo_k6_20260113T081809.md`.
- 2026-01-13T08:35:25Z codex (git 3ade558198cb5da0dba2dac3b8393823e2eb4fa5; dirty): renamed `molt_django_adapter` to `molt_db_adapter`, updated docs/README/STATUS/ROADMAP/0700/0701/0702/0915 and tests, and added a feature-gated async pool primitive with a built-in cancellation token in `runtime/molt-db/src/async_pool.rs` (tokio-backed). Tests: `cargo test -p molt-db --features async`, `uv run --python 3.12 python3 -m pytest tests/test_molt_db_adapter_contracts.py tests/test_django_demo.py`. Bench: not run.
- 2026-01-13T09:16:41Z codex (git 3ade558198cb5da0dba2dac3b8393823e2eb4fa5; dirty): fixed lambda default binding by routing dynamic calls through CALL_BIND and removed dead CALL_FUNC fallback; tightened bytes/bytearray + chr/ord parity in wasm harness/runtime; refactored molt-db Postgres TLS setup and async pool (Default CancelToken + no await-holding-lock); added tokio-postgres to molt-worker and silenced dead_code warnings for pending DB-query helpers; updated sqlparser Query wrapper for new fields. Tests: `tools/dev.py lint`, `tools/dev.py test`, `cargo test`, `cargo clippy -- -D warnings`. Bench: `uv run --python 3.14 python3 tools/bench.py --json-out bench/results/bench.json`, `uv run --python 3.14 python3 tools/bench_wasm.py --json-out bench/results/bench_wasm.json`.
- 2026-01-13T09:26:52Z codex (git f22551aa876c6e3eab7576db45a2523713f8a753; clean): ran `cargo fmt` to fix CI rustfmt failure, committed `style: cargo fmt`, pushed, and confirmed CI green (run 20951357217).
- 2026-01-13T09:48:50Z codex (git 6b56c62dd73429da27a98be1b3b967b95a649fad; dirty): implemented async Postgres connector + statement cache in `molt-db`, added sync/async runtime selection and `db_query` handling in `molt-worker` (SQLite + Postgres cancel-aware), added db_query unit tests, wired default exports, and updated README/ROADMAP/STATUS + DB/offload specs/quickstart. Tests: `cargo test -p molt-worker`.
- 2026-01-13T10:22:11Z codex (git 6b56c62dd73429da27a98be1b3b967b95a649fad; dirty): added Arrow IPC result encoding for db_query in molt-worker with type inference and db-specific metrics (db_alias/tag/row_count/bytes/result_format), expanded Postgres decoding to uuid/json/date/time string outputs, and enabled arrow_ipc passthrough in molt_accel codecs. Updated DB specs/STATUS/ROADMAP/metrics slide and added Arrow IPC + codec tests. Tests: `cargo test -p molt-worker`, `uv run --python 3.12 python3 -m pytest tests/test_molt_accel_client.py`.
- 2026-01-13T10:54:12Z codex (git 6b56c62dd73429da27a98be1b3b967b95a649fad; dirty): added in-place augmented assignment semantics for list/bytearray/set (name/attribute/subscript targets), tightened set in-place operators to require set-like RHS with CPython error strings, and standardized iterable TypeError messages; updated wasm harness to mirror iterable/in-place errors; added `tests/differential/basic/augassign_inplace.py`; refreshed type/status docs; fixed molt-worker clippy nits. Tests: `uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/augassign_inplace.py`, `uv run --python 3.12 python3 tools/dev.py lint`, `uv run --python 3.12 python3 tools/dev.py test`, `cargo test`, `cargo clippy -- -D warnings`, `uv run --python 3.14 python3 tools/bench.py --json-out bench/results/bench.json`, `uv run --python 3.14 python3 tools/bench_wasm.py --json-out bench/results/bench_wasm.json`.
- 2026-01-13T15:08:00Z codex (git c0c3950737f54457842738232b015497d0c89125; dirty): added structured Postgres array/range/interval decoding in `molt-worker` with Arrow IPC rejection for those types; added pg decode unit tests; added wasm guardrails in `molt-db` (target-specific deps + compile-time errors for sqlite/postgres on wasm); updated docs/spec/0700/0701/0915/STATUS, ROADMAP, and README. Tests: `cargo test -p molt-worker`. Bench: not run.
- 2026-01-13T15:22:43Z codex (git c0c3950737f54457842738232b015497d0c89125; dirty): implemented Postgres multirange decoding and array lower-bound preservation in `molt-worker`, refactored range parsing helper, and updated docs/spec/0700/0701/0915/STATUS plus ROADMAP/README to reflect multirange support and remaining Arrow IPC gaps. Tests: `cargo test -p molt-worker`. Bench: not run.
- 2026-01-13T15:52:19Z codex (git 0e079e6d2c617dcfee4afe59b798cbaf60debe03; dirty): added Arrow IPC complex-type support (arrays/ranges/intervals/multiranges) with struct/list encoding and a new unit test, hardened async Postgres prepare/decoding cancellation/timeout handling, and updated docs/spec/0700/0701/0915. Tests: `cargo test -p molt-worker`. Bench: not run.
- 2026-01-13T16:00:33Z codex (git 0e079e6d2c617dcfee4afe59b798cbaf60debe03; dirty): updated STATUS/ROADMAP/README and DB specs for Arrow IPC complex-type support, and added wasm DB parity TODOs in 0701/ROADMAP. Tests: not run (docs-only updates).
- 2026-01-13T16:09:23Z codex: starting proceed step 1 (wasm DB parity): define WIT DB host interface, add wasm shims/capability gates, update specs/STATUS/ROADMAP as needed; inspect `wit/molt-runtime.wit`, `runtime/molt-backend/src/wasm.rs`, `runtime/molt-runtime/src/lib.rs`, and `runtime/molt-db`.
- 2026-01-13T16:29:00Z codex: added WIT DB host intrinsics (`db_query`/`db_exec`), runtime capability gating + host hook shims, wasm harness/run_wasm DB stubs, and updated DB specs/STATUS/ROADMAP/README for wasm DB host interface. Tests: not run.
- 2026-01-13T15:36:31Z codex (git c0c3950737f54457842738232b015497d0c89125; dirty): added `__index__` parity for indexing/slicing with CPython overflow messages, extended set algebra/in-place ops to accept dict_keys/items, updated wasm harness dict views + index handling, and added differential coverage (`index_dunder.py`, `set_view_ops.py`, updated `augassign_inplace.py`). Updated STATUS/type coverage matrix and regenerated native/wasm bench JSON. Tests: `tools/dev.py lint`, `tools/dev.py test`, `cargo test`, `cargo clippy -- -D warnings` (fails in `runtime/molt-worker/src/main.rs` while-let loop). Bench: `uv run --python 3.14 python3 tools/bench.py --json-out bench/results/bench.json`, `uv run --python 3.14 python3 tools/bench_wasm.py --json-out bench/results/bench_wasm.json`.
- 2026-01-13T15:41:02Z codex (git 0e079e6b1d571bd6a5d21d2b889ea288c2e02240; dirty): documented async/IO/DB/WASM parity cluster plan in `ROADMAP.md` + STATUS, preparing to execute step 1 (async runtime core).
- 2026-01-13T15:42:17Z codex: starting slice assignment/deletion parity for list/bytearray/memoryview (runtime+wasm), __index__ handling, and differential+status updates.
- 2026-01-13T16:10:01Z codex: implemented list/bytearray slice assignment+deletion and memoryview delete errors in runtime, added del_index op wiring across frontend/backend/WIT, and extended wasm harness slice assignment handling + __index__ error parity; added differential coverage in `tests/differential/basic/slice_assign.py` and updated STATUS/0014 matrix. Tests: not run (not requested).
- 2026-01-13T16:15:18Z codex: extended wasm harness with minimal memoryview support (memoryview_new/tobytes, len, assignment path helpers) to keep slice assignment/deletion parity; updated CHECKPOINT summary. Tests: not run.
- 2026-01-13T16:41:41Z codex (git 0e079e6d2c617dcfee4afe59b798cbaf60debe03; dirty): implemented async Task/Future + contextvars shims, added await lowering to honor __await__ for stdlib awaitables, injected cancellation checks into molt_future_poll_fn, and added differential coverage for contextvars + task/future basics (gather stubbed). Tests: `uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/contextvars_basic.py`, `uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/asyncio_task_basic.py`, `uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/asyncio_future_basic.py`.
- 2026-01-13T16:44:28Z codex (git 0e079e6d2c617dcfee4afe59b798cbaf60debe03; dirty): adjusted await lowering to call __await__ only when present, removed asyncio.run ASYNC_BLOCK_ON special-case to allow loop tracking, restored create_task running-loop guard, and kept gather stubbed (removed gather differential). Tests: `uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/asyncio_shim.py`, `uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/asyncio_task_basic.py`, `uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/asyncio_future_basic.py`.
- 2026-01-13T16:51:28Z codex: implemented asyncio gather + fixed Future.__await__/exception base classes, added differential gather coverage, updated STATUS + stdlib matrix. Tests: not run (not requested).
- 2026-01-13T16:58:45Z codex: scope locked for wasm DB host adapter (run_wasm.js) + db_exec implementation in molt-worker (SQLite/Postgres) + molt_db_adapter exec payload helper, with spec/STATUS/ROADMAP/README updates and checkpoint refresh.
- 2026-01-13T16:59:08Z codex: updated AGENTS.md and GEMINI.md to require explicit AGENT_LOCKS writes before non-doc code/test work, clarify doc-sharing norms, and warn about lower-level vs higher-level overlap risks. Tests: not run.
- 2026-01-13T17:01:12Z codex: starting wasm slice read parity cluster (SLICE op for list/tuple/bytes/bytearray/str/memoryview) scoped to `tests/wasm_harness.py` and `run_wasm.js` after updating AGENT_LOCKS.
- 2026-01-13T17:06:16Z codex: pivoting to free-variable capture parity; will inspect compiler lowering and runtime closure/cell handling (frontend/runtime/backend) and add differential coverage as needed.
- 2026-01-13T17:10:12Z codex: implemented async free-var boxing by treating async locals as outer scope, loading/storing boxed cells via closure slots; restored async free-var test in `tests/differential/basic/asyncio_event_wait_for.py` and added `tests/differential/basic/free_vars_basic.py`. Tests: not run.
- 2026-01-13T17:18:23Z codex: cleared stale AGENT_LOCKS entries per new unique-lock policy; no active locks remain.
- 2026-01-13T17:20:35Z codex (git 0e079e6b1d571bd6a5d21d2b889ea288c2e02240; dirty): async core work: added cancellation check in `molt_anext_default_poll`, added `asyncio.Event` + simplified `gather`, restored `Future.__await__` to return coroutine; `asyncio.wait_for` left as NotImplemented due to backend verifier/exception stack issues (documented in STATUS/ROADMAP). Added `tests/differential/basic/asyncio_event_basic.py`; removed wait_for test attempt. Ran molt_diff for `asyncio_event_basic.py`, `asyncio_task_basic.py`, `asyncio_future_basic.py` (pass).
- 2026-01-13T17:21:25Z codex: implemented `db_exec` in molt-worker (SQLite/Postgres) with allow_write gating + metrics and added a SQLite roundtrip test; wired Node/WASI DB host adapter in `run_wasm.js` (stdio -> molt-worker, msgpack header streaming, cancel polling) plus `molt_header_size` export; added `build_db_exec_payload`, updated manifests/stubs/tests, and refreshed 0700/0701/0911/0915/STATUS/ROADMAP/README. Tests: not run (not requested).
- 2026-01-13T17:23:13Z codex-4698 (git 0e079e6b1d571bd6a5d21d2b889ea288c2e02240; dirty): starting async core follow-up: investigate safe asyncio.wait_for/timeouts + cancellation-aware Event cleanup; scope runtime cancel/await plumbing + asyncio shim + differential tests.
- 2026-01-13T17:44:49Z codex-4698 (git 0e079e6d2c617dcfee4afe59b798cbaf60debe03; dirty): implemented `asyncio.wait_for` timeouts via polling + timeout task (no cancellation of timed-out tasks yet); added differential coverage in `tests/differential/basic/asyncio_wait_for_basic.py`; updated `docs/spec/STATUS.md`, `docs/spec/0015_STDLIB_COMPATIBILITY_MATRIX.md`, and `ROADMAP.md` to reflect wait_for support + cancellation gap. Tests: `uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/asyncio_wait_for_basic.py`.
- 2026-01-13T17:45:52Z codex-34257 (git 0e079e6d2c617dcfee4afe59b798cbaf60debe03; dirty): starting async follow-up to add cancellation-aware `asyncio.wait_for` timeouts + Event waiter cleanup in runtime/stdlib/tests.
- 2026-01-13T18:22:34Z codex-34257 (git 0e079e6d2c617dcfee4afe59b798cbaf60debe03; dirty): added Event waiter cleanup via task teardown map in `src/molt/stdlib/asyncio.py`; attempted wait_for cancellation but async exception propagation still aborts (wait_for restored to NotImplemented, docs updated). Runtime: broadened `molt_raise` to coerce non-exception objects; added per-task exception stack storage in scheduler/block_on and a cancellation underflow guard. Docs: STATUS/0015/ROADMAP updated to mark wait_for pending. Tests: `uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/asyncio_event_basic.py`, `uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/asyncio_task_basic.py`.
- 2026-01-13T17:21:54Z codex: starting scoping parity work (nonlocal declarations + closure capture across nested/class scopes) scoped to `src/molt/frontend/__init__.py` and docs/status/matrix; tests deferred due to existing lock on `tests/differential/basic/`.
- 2026-01-13T17:33:36Z codex-13713: starting Django accel/offload demo alignment; will unify payload builders (list_items/compute/offload_table), add JSON-body parsing for offload_table, enrich molt_accel metrics/cancel-checks, update demo/spec docs, and extend tests for contracts/metrics/demo parity.
- 2026-01-13T17:29:33Z codex: implemented nonlocal + closure store handling and outer-scope detection (async/generator + class methods), added scoping differential test `tests/differential/scoping/nonlocal_and_class_closure.py`, updated STATUS/0014 matrix. Tests: not run.
- 2026-01-13T17:37:58Z codex: cleared tests/differential/basic/ from codex-4698 lock, moved scoping test into basic, and released temporary lock.
- 2026-01-13T17:39:59Z codex-13713: unified demo payload builders in `molt_accel.contracts` (lenient list_items limit default, compute/offload_table JSON body parsing) and wired Django demo views; added auto cancel-check detection and payload/response byte metrics in molt_accel; aligned offload_table fallback response to `sample`; updated tests and docs (0912 spec + quickstart). Tests: `uv run --python 3.12 python3 -m pytest tests/test_molt_accel_contracts.py tests/test_molt_accel_client.py tests/test_django_demo.py`.
- 2026-01-13T17:41:39Z codex-13713: updated `docs/spec/STATUS.md` to reflect molt_accel auto cancel-check detection, payload/response byte metrics, and shared demo payload builders. Tests/bench: not run (doc-only).
- 2026-01-13T17:42:55Z codex-13713: synced README/ROADMAP offload demo notes with STATUS (auto cancel-check detection, payload/response byte metrics, shared demo payload builders). Tests/bench: not run (doc-only).
- 2026-01-13T17:45:46Z codex-13713: ran `bench/scripts/run_stack.sh` (baseline 2035.6 req/s p99=67.9ms p999=71.9ms; offload 1532.9 req/s p99=92.9ms p999=98.2ms; offload_table 1693.0 req/s p99=47.2ms p999=69.4ms; errors 0%). Artifacts: `bench/results/demo_k6_20260113T174533.json`, `bench/results/demo_k6_20260113T174533.md`.
- 2026-01-13T17:47:09Z codex-96239: tightened AGENT_LOCKS guidance in `AGENTS.md` and `GEMINI.md` to require proactive lock release and to use Codex CLI parent PID for unique lock names; cleared temporary locks. Tests: not run.
- 2026-01-13T17:48:50Z codex-96239: fixed non-generator function scoping setup by populating nonlocal/assigned/scope_assigned before visiting body so inner free-var resolution sees outer assignments; released `src/molt/frontend/__init__.py` lock. Tests: not run (tests/differential/basic locked by another agent).
- 2026-01-13T17:58:26Z codex-13713: ran `uv run --python 3.14 python3 tools/bench.py --json-out bench/results/bench.json` and `uv run --python 3.14 python3 tools/bench_wasm.py --json-out bench/results/bench_wasm.json`; updated README performance summary. WASM bench failures: bench_async_await, bench_channel_throughput (compile error: local.set expected i64, call_indirect returned i32).
- 2026-01-13T18:00:18Z codex-96239: reinforced mindset note in `AGENTS.md` and `GEMINI.md` emphasizing low-level core + high-level abstractions and embracing complexity. Tests: not run.
- 2026-01-13T18:01:23Z codex-96239: strengthened the project ethos line in `AGENTS.md` and `GEMINI.md` to emphasize aspirational, genius-level rigor with gritty execution. Tests: not run.
- 2026-01-13T18:02:19Z codex-96239: strengthened ethos line in `AGENTS.md`/`GEMINI.md` to emphasize proactive ownership of complex tasks. Tests: not run.
- 2026-01-13T18:03:02Z codex-96239: escalated ethos line in `AGENTS.md`/`GEMINI.md` to "seek the hardest problems first" and "own complexity end-to-end". Tests: not run.
- 2026-01-13T18:27:07Z codex-98895: starting full lint/test/fuzz/bench sweep; focus on async exception propagation + asyncio.wait_for parity; locked runtime/asyncio/tests scope.
- 2026-01-13T18:30:12Z codex-7757: starting benchmark run (native+wasm bench JSON) and drafting profiling/optimization plan; will update bench/results, OPTIMIZATIONS_PLAN.md if needed, and CHECKPOINT.md.
- 2026-01-13T18:44:12Z codex-7757 (git 0e079e6d2c617dcfee4afe59b798cbaf60debe03; dirty): ran `uv run --python 3.14 python3 tools/bench.py --json-out bench/results/bench.json` and `uv run --python 3.14 python3 tools/bench_wasm.py --json-out bench/results/bench_wasm.json`. WASM async benches failed to compile due to `src/molt/stdlib/asyncio.py:48` base-class ordering compat error. Added OPT-0004 profiling/optimization plan in `OPTIMIZATIONS_PLAN.md`.
- 2026-01-13T18:46:23Z codex-7757: starting Phase 0 profiling harness work under `tools/`/`bench/` plus hotspot triage; blocked on `src/molt/stdlib/asyncio.py` (locked by codex-98895) for wasm async compat fix.
- 2026-01-13T18:51:54Z codex-7757: added `tools/profile.py` profiling harness (CPU/alloc + optional compiler cProfile) and documented it in `LOGGING_AND_BENCHMARK_CONVENTIONS.md`. No tests or benches run; wasm async fix still blocked by lock.
- 2026-01-13T22:09:36Z codex-7757: restarting per user request: run full native+wasm benches, then start optimization pass based on results; locked `bench/results/`.
- 2026-01-13T22:32:23Z codex-7757: optimized tuple building/index fast path (reuse tuple builder vec + skip eager index error formatting) in `runtime/molt-runtime/src/lib.rs`. Benches re-run: `uv run --python 3.14 python3 tools/bench.py --json-out bench/results/bench.json` + `tools/bench_wasm.py`. Notable Molt improvements vs pre-opt log: tuple_index 0.1859s -> 0.0580s (3.21x), tuple_pack 0.1788s -> 0.0539s (3.32x), deeply_nested_loop 13.2052s -> 8.9375s (1.48x), min_list 0.1718s -> 0.0693s (2.48x), max_list 0.1712s -> 0.0692s (2.47x).
- 2026-01-13T22:35:17Z codex-7757: updated `README.md` Performance & Comparisons with latest native/wasm bench summaries and refreshed baseline microbench table. No tests run.
- 2026-01-13T22:42:08Z codex-7757: starting profiling harness expansion + allocation-focused optimization (runtime list builder reuse + profiling counters), plus re-run full benches and refresh README summary.
- 2026-01-13T23:11:44Z codex-7757: expanded `tools/profile.py` (molt profile capture, perf-stat option, env overrides, metrics parsing), added list builder reuse + list-from-range/indexable fast path, added allocation counters to runtime profile dump, and refreshed README perf summary after full native/wasm benches. Profile evidence: `bench_sum_list.py` alloc_count dropped from ~1,000,017 to 14 and tuple_allocs from ~1,000,002 to 1 (see `logs/benchmarks/profile_20260113T225855Z` vs `profile_20260113T230419Z`).
- 2026-01-13T20:18:45Z codex-98895 (git 0e079e6d2c617dcfee4afe59b798cbaf60debe03; dirty): starting async exception propagation fix by isolating exception stacks per await (state_transition + runtime), re-enabling asyncio.wait_for/gather coverage, then running full lint/test/fuzz/bench before commit+push+CI.
- 2026-01-13T21:51:10Z codex-98895 (git 0e079e6d2c617dcfee4afe59b798cbaf60debe03; dirty): refreshed async exception propagation by isolating task exception stacks/last exceptions, added GIL guard for non-wasm scheduler/block_on polling, routed future polling through per-task stack helper, and re-enabled asyncio.wait_for/gather coverage; fixed backend IfFrame terminal handling, function symbol caching for nested scopes, and DbNamedParam serialization; updated fuzz target signature; refreshed README performance summary after new native+wasm bench runs. Tests: `uv run --python 3.12 python3 tools/dev.py lint`, `uv run --python 3.12 python3 tools/dev.py test`, `cargo test`, `cargo clippy -- -D warnings`. Fuzz: `cargo +nightly fuzz run string_ops -- -runs=100000` (warnings: function_casts_as_integer). Bench: `uv run --python 3.14 python3 tools/bench.py --json-out bench/results/bench.json`, `uv run --python 3.14 python3 tools/bench_wasm.py --json-out bench/results/bench_wasm.json`.
- 2026-01-13T22:02:09Z codex-98895 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): documented a hard rule to never change Python semantics just to satisfy differential tests in `AGENTS.md` and `GEMINI.md`, and expanded WASM bench instructions to compare against native CPython baselines in `README.md`/`LOGGING_AND_BENCHMARK_CONVENTIONS.md`.
- 2026-01-14T00:01:16Z codex-7757: starting attr-name cache/alloc hotspot triage in `runtime/molt-runtime/src/lib.rs` (add cache hits/misses counters + LRU cache) and will re-profile after change.
- 2026-01-13T23:47:45Z codex-7757: added alloc-site tracking for string allocations (`MOLT_PROFILE_ALLOC_SITES`), parsed into `tools/profile.py`, and cached `molt_string_from_bytes` with LRU + counters (string allocs dropped from ~3M to ~35 on bench_struct); updated README perf summary after full native/wasm bench runs. Tests/bench: `uv run --python 3.14 python3 tools/profile.py --bench bench_struct.py --bench bench_attr_access.py --molt-profile-alloc-sites --molt-profile-alloc-sites-limit 5 --cpu-tool time --alloc-tool time` (twice), `uv run --python 3.14 python3 tools/bench.py --json-out bench/results/bench.json`, `uv run --python 3.14 python3 tools/bench_wasm.py --json-out bench/results/bench_wasm.json`.
- 2026-01-13T23:59:59Z codex-7757: profiled bench_struct/bench_attr_access/bench_deeply_nested_loop with alloc-site tracking, updated `tests/test_codec_lowering.py` to reflect list(range) lowering (loop ops instead of iter), and re-ran lint + full dev test matrix (3.12/3.13/3.14 + differential). Tests: `uv run --python 3.12 python3 tools/dev.py lint`, `uv run --python 3.12 python3 tools/dev.py test`, `uv run --python 3.14 python3 tools/profile.py --bench bench_struct.py --bench bench_attr_access.py --bench bench_deeply_nested_loop.py --molt-profile-alloc-sites --molt-profile-alloc-sites-limit 5 --cpu-tool time --alloc-tool time`.
- 2026-01-14T00:05:50Z codex-7757: added SIMD usage counters to runtime profile output (sum/min/max reductions, prod trivial AVX2, memchr simd128, simdutf) and profiled reduction/string/deeply-nested loop benches (`profile_20260114T000447Z`) to quantify SIMD path hits; observed SIMD reductions hitting NEON on list sum/min/max and no SIMD usage in deeply nested loop or string benches. Tests: not re-run (behavioral-only counters).
- 2026-01-14T00:12:15Z codex-7757: added CPU feature dump to runtime profiling, parsed it in `tools/profile.py`, documented it in profiling conventions, and re-profiled vector/string/deeply-nested benchmarks (`profile_20260114T001042Z`) to capture SIMD availability + usage. Tests: not run (profiling only).
- 2026-01-14T00:13:29Z codex-7757: added SIMD coverage expansion plan entry (OPT-0005), re-profiled vector/string/deeply-nested benchmarks with CPU feature dump (`profile_20260114T001042Z`), and captured SIMD usage counters showing only reductions hit SIMD on NEON hosts. Tests: not run.
- 2026-01-14T00:34:57Z codex-7757 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): added constant nested-while strength reduction in `src/molt/frontend/__init__.py`, added `tests/test_codec_lowering.py` coverage, fixed wasm CPU feature dump to use `cfg!(target_feature = \"simd128\")`, and refreshed README perf summary after full native/wasm benches. Tests: `uv run --python 3.12 python3 tools/dev.py test`. Bench: `uv run --python 3.14 python3 tools/bench.py --json-out bench/results/bench.json`, `uv run --python 3.14 python3 tools/bench_wasm.py --json-out bench/results/bench_wasm.json`.
- 2026-01-14T00:39:18Z codex-7757 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): restricted nested-while folding to locals-only (avoid speculative loads) and re-ran the full `tools/dev.py test` matrix. Tests: `uv run --python 3.12 python3 tools/dev.py test`.
- 2026-01-14T00:59:54Z codex-7757 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): added profiling summary output to `tools/profile.py` + documented it; ran full-bench profiling (`profile_20260114T004549Z`) and targeted msgpack profiling (`profile_20260114T004947Z`); optimized JSON/CBOR/MsgPack string decoding to use the string-from-bytes cache (string_allocs in parse_msgpack dropped ~64k -> 10); refreshed native+wasm bench outputs and README performance summary. Tests: `uv run --python 3.12 python3 tools/dev.py test`. Bench: `uv run --python 3.14 python3 tools/bench.py --json-out bench/results/bench.json`, `uv run --python 3.14 python3 tools/bench_wasm.py --json-out bench/results/bench_wasm.json`.
- 2026-01-14T01:25:41Z codex-7757 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): added CSV parse bench + WASM string parity test, expanded `tools/profile.py` summary output, and switched string split parts to use the string-from-bytes cache; refreshed README perf summary after new native+WASM bench runs (`bench/results/bench.json`, `bench/results/bench_wasm.json`) and profiled CSV allocs (`logs/benchmarks/profile_20260114T011047Z`, `logs/benchmarks/profile_20260114T011401Z`). Tests: `uv run --python 3.12 python3 tools/dev.py test`.
- 2026-01-14T01:27:19Z codex-98895 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): starting full multidimensional memoryview + buffer export parity (runtime + wasm harness + WIT), with differential tests, wasm parity tests, and bench updates.
- 2026-01-14T01:44:59Z codex-7757 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): added super-bench flag + stats output to `tools/bench.py`/`tools/bench_wasm.py`, expanded WASM parity tests (bytes ops + new memoryview test), and updated AGENTS/GEMINI/README/STATUS/ROADMAP/LOGGING with super-bench + release-tag + parity coverage notes. Profiled all benches with alloc-site summary (`logs/benchmarks/profile_20260114T014013Z`). Tests: `uv run --python 3.12 python3 -m pytest tests/test_wasm_bytes_ops.py tests/test_wasm_memoryview_ops.py tests/test_wasm_string_ops.py` (FAILED: bytes startswith/endswith/count call_bind TypeError; memoryview index/tobytes returned None).
- 2026-01-14T02:24:22Z codex-98895: resuming multidimensional memoryview + buffer export parity; will update wasm harness/run_wasm.js, differential/wasm tests, benches, and docs/spec/roadmap/status; keep native/wasm parity and avoid CHECKPOINT.md.
- 2026-01-14T02:58:42Z codex-98895: completed multidimensional memoryview parity (runtime/wasm harness/front-end cast+slice handling), added memoryview differential + wasm parity coverage, updated memoryview bench and docs (STATUS/0014/ROADMAP). Tests: `uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/memoryview_multidim.py`, `uv run --python 3.12 python3 -m pytest tests/test_wasm_memoryview_ops.py`.
- 2026-01-14T03:25:00Z codex-7757 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): implemented bytes/bytearray startswith/endswith/count (with slice variants) lowering + runtime exports + wasm backend imports/WIT updates; added wasm harness bytes ops shims and fixed bytes indexing override in wasm bytes parity test. Tests: `uv run --python 3.12 python3 -m pytest tests/test_wasm_bytes_ops.py tests/test_wasm_memoryview_ops.py tests/test_wasm_string_ops.py`.
- 2026-01-14T03:30:59Z codex-7757: starting compatibility/TODO survey, plan documentation, and phased implementation of prioritized type/stdlib gaps.
- 2026-01-14T03:57:12Z codex-7757: implemented iterable unpacking + starred targets with CPython error semantics, added `tests/differential/basic/unpack_assignment.py`, updated 0014/STATUS/ROADMAP. Tests: `uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/unpack_assignment.py`.
- 2026-01-14T04:11:18Z codex-7757: starting generator state objects + StopIteration semantics (runtime + differential coverage).
- 2026-01-14T03:39:13Z codex-64253 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): reviewed ROADMAP/STATUS to propose next work items; updated CHECKPOINT/AGENT_MEMORY. Tests: not run.
- 2026-01-14T03:39:45Z codex-64253 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): starting format-protocol work (goal: __format__ fallback + named field access + locale-aware grouping). Scope: runtime format dispatch and format spec handling; frontend string.format/f-string lowering (blocked by lock on src/molt/frontend/__init__.py); add differential tests in non-basic path; update STATUS/0014/ROADMAP. Tests/bench: pending.
- 2026-01-14T04:08:26Z codex-64253 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): implemented __format__ dispatch + locale-aware `n` formatting (host locale) in runtime, added format field access (attr/index) and f-string empty-spec formatting, updated STATUS/0014/ROADMAP, and added differential formatting coverage. Tests: `uv run --python 3.12 python3 tests/molt_diff.py tests/differential/formatting/format_protocol.py`.
- 2026-01-14T05:06:17Z codex-64253 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): start follow-up to add builtin format(), enable dynamic f-string format specs, extend formatting differential coverage, and update docs/status. Tests: pending.
- 2026-01-14T05:12:23Z codex-64253 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): added builtin format() handling (direct call + defaults), enabled dynamic f-string format specs, extended formatting differential coverage, updated STATUS/0014/ROADMAP, and refreshed builtins exports. Tests: `uv run --python 3.12 python3 tests/molt_diff.py tests/differential/formatting/format_protocol.py`, `uv run --python 3.12 python3 -m pytest tests/test_codec_lowering.py`.
- 2026-01-14T05:17:54Z codex-64253 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): enabled non-ASCII locale separators in native `n` formatting (string separators + grouping), updated STATUS/0014/ROADMAP to leave WASM locale gap. Tests: `uv run --python 3.12 python3 tests/molt_diff.py tests/differential/formatting/format_protocol.py`.
- 2026-01-14T05:23:02Z codex-64253 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): added WASM locale-aware `n` formatting via `MOLT_WASM_LOCALE_*` env (seeded in run_wasm.js), updated STATUS/0014/ROADMAP, and revalidated formatting differential coverage. Tests: `uv run --python 3.12 python3 tests/molt_diff.py tests/differential/formatting/format_protocol.py`.
- 2026-01-14T04:42:55Z codex-7757: added StopIteration.value propagation (frontend op + runtime + wasm harness), marked generators closed on escaped exceptions, updated generator protocol differential coverage and STATUS/0014/ROADMAP. Tests: not run.
- 2026-01-14T04:46:06Z codex-7757: resuming StopIteration.value/generator semantics cleanup + verification; scope runtime/frontend/backend/wasm harness + generator differential tests.
- 2026-01-14T04:48:57Z codex-7757: completed StopIteration.value propagation + generator close on escaped exceptions; updated wasm harness/WIT/backend/front-end ops and generator differential coverage; test: `uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/generator_protocol.py`.
- 2026-01-14T04:50:46Z codex-7757: running wasm parity pytest subset and molt-runtime cargo tests.
- 2026-01-14T04:55:16Z codex-7757: ran wasm parity pytest subset (3 tests) and `cargo test -p molt-runtime` (warnings about unreachable code near raise macro lines 1741, 1749, 1757, 1775, 1802); all tests passed.
- 2026-01-14T05:01:23Z codex-7757: removed unreachable-code returns after raise! in memoryview_write_scalar; reran `cargo test -p molt-runtime` (warnings cleared).
- 2026-01-14T05:02:27Z codex-7757: re-ran wasm parity pytest subset (bytes/memoryview/string ops) after warning cleanup; all passed.
- 2026-01-14T05:05:59Z codex-7757: starting wasm asyncio compat fix in `src/molt/stdlib/asyncio.py`.
- 2026-01-14T05:16:10Z codex-7757: adjusted asyncio.CancelledError to inherit BaseException, added STATUS note, and validated wasm build with `PYTHONPATH=src uv run --python 3.14 python3 -m molt.cli build --target wasm tests/benchmarks/bench_async_await.py` (note: uv recreated .venv).
- 2026-01-14T05:18:18Z codex-7757: coordination request to codex-64253: I updated `docs/spec/STATUS.md` to note asyncio.CancelledError now subclasses BaseException (CPython parity). Please advise whether to keep or revert, and share any tasks you want me to pick up. Proposed protocol: leave explicit coordination entries in AGENT_MEMORY with action items + ack, and avoid touching locked files until acked.
- 2026-01-14T05:27:09Z codex-7757: ran wasm smoke bench after asyncio fix: `PYTHONPATH=src uv run --python 3.14 python3 tools/bench_wasm.py --smoke --json-out bench/results/bench_wasm_smoke_async_fix.json`.
- 2026-01-14T05:27:40Z codex-64253 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): ran `uv run --python 3.12 python3 tools/dev.py test`; pytest segments reported 94 passed/5 skipped for one or more interpreters (saw 3.14 complete), then the 3.12 differential suite failed. First failure was a mismatch in `tests/differential/basic/augassign_inplace.py` (bools printed as 1/0 vs True/False), then `molt_diff` aborted on `tests/differential/basic/kwargs_mapping.py` because `/Users/adpena/PycharmProjects/molt/.venv/bin/python3` was missing.
- 2026-01-14T05:30:02Z codex-7757: starting TC2 generator state object support (runtime/frontend/backend/wasm + differential coverage).
- 2026-01-14T05:30:30Z codex-64253 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): scope lock for `tests/molt_diff.py` + `tools/verified_subset.py` to fix missing .venv interpreter in differential harness; bool repr mismatch fix pending due to lock on `runtime/molt-runtime/src/lib.rs`.
- 2026-01-14T05:32:04Z codex-64253 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): added python executable fallback in `tests/molt_diff.py` using `sys._base_executable` when the venv path is missing to avoid differential aborts; no tests rerun yet. Bool repr mismatch fix still blocked by lock on `runtime/molt-runtime/src/lib.rs`.
- 2026-01-14T05:33:27Z codex-64253 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): waiting on codex-7757 lock for `runtime/molt-runtime/src/lib.rs` and `tests/differential/basic/` to fix bool repr mismatch; will proceed once lock clears.
- 2026-01-14T06:17:01Z codex-7757 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): implemented generator state objects (running/started flags, gi_frame stub with f_lasti, gi_yieldfrom, generator methods) in runtime + wasm harness; bumped generator control size and added yield-from slot tracking in frontend; added inspect.getgeneratorstate + differential coverage; updated STATUS/0014/ROADMAP. Tests: not run (known differential failures elsewhere).
- 2026-01-14T12:14:25Z codex-7757: diagnosed generator state failure: `generator_frame_new` calls `molt_alloc(MoltObject::from_int(...).bits())`, likely producing a misaligned payload size and a bogus instance dict pointer, so `f_lasti` never persists. Proposed fix is to pass the raw size (`std::mem::size_of::<u64>() as u64`) to `molt_alloc` in `runtime/molt-runtime/src/lib.rs`; need handoff for `runtime/molt-runtime/src/lib.rs` + `tests/differential/basic/` locks held by codex-64253 before patching and rerunning `tests/differential/basic/generator_state.py`.
- 2026-01-14T12:10:00Z codex-64253 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): fixed bool formatting in `runtime/molt-runtime/src/lib.rs` to emit True/False only when the format spec is empty; f-string/integer formatting now matches CPython for bools. Differential checks: `uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/augassign_inplace.py`, `uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/kwargs_mapping.py`.
- 2026-01-14T13:05:30Z codex-7757: fixed generator state + closure capture by updating generator arg storage offsets (native+wasm), adding closure tuple reuse in the frontend for generator allocation, and making `molt_get_attr_name_default` swallow AttributeError to honor defaults. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/generator_state.py` (pass).
- 2026-01-14T13:07:09Z codex-7757: updated CHECKPOINT.md and cleared AGENT_LOCKS for generator-state fixes; no additional tests run.
- 2026-01-14T15:17:52Z codex-7757: starting work on wasm bench compile error (i64/i32 local.set mismatch); locking wasm backend files for investigation.
- 2026-01-14T15:18:58Z codex-64253 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): locking `src/molt/stdlib/functools.py` to implement missing update_wrapper/wraps helpers per stdlib-compat TODO.
- 2026-01-14T15:19:53Z codex-64253 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): extending `tests/differential/basic/functools_partial_lru.py` to cover lru_cache wrapper metadata (__name__/__doc__/__wrapped__).
- 2026-01-14T15:20:21Z codex-7757: switching scope to add a super-bench flag/statistics in tools/bench.py and tools/bench_wasm.py (multi-run mean/median/variance/range); updated locks.
- 2026-01-14T15:21:15Z codex-7757: pivoting to benchmark realism for nested loops/CSV parsing; locking bench_csv_parse.py and bench_deeply_nested_loop.py.
- 2026-01-14T15:22:58Z codex-7757: updated deeply nested loop benchmark to use realistic data scanning + arithmetic (still 4 nested loops); no tests run. Locks released.

- 2026-01-14T15:24:57Z codex-81190: starting stdlib bisect module (bisect_left/right, insort_left/right) + differential coverage + docs/roadmap updates.
- 2026-01-14T15:25:55Z codex-7757: updated bench_csv_parse to generate header+rows with mixed fields and parse int/conditional work; no tests run.
- 2026-01-14T15:27:23Z codex-7757: adding wide CSV parsing benchmark variant; locking tools/bench.py, tools/bench_wasm.py, tests/benchmarks/bench_csv_parse_wide.py.
- 2026-01-14T15:27:58Z codex-7757: added bench_csv_parse_wide benchmark and wired into native/wasm bench lists; no tests run. Locks released.
- 2026-01-14T15:39:23Z codex-7757: fixed bench_deeply_nested_loop to avoid list comprehension/bitwise XOR, added sys._base_executable fallback in tools/bench_wasm.py, reran benches. Bench: `uv run --python 3.14 python3 tools/bench.py --json-out bench/results/bench.json` (pass). Bench: `uv run --python 3.14 python3 tools/bench_wasm.py --json-out bench/results/bench_wasm.json` (first run failed due to missing .venv python; rerun after fix succeeded).
- 2026-01-14T15:40:00Z codex-64253 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): fixed `functools.update_wrapper` to avoid dynamic getattr loops (broken in Molt) by using explicit attribute assignments for defaults; lru_cache now picks up correct __name__/__doc__/__wrapped__ metadata. Added differential coverage in `tests/differential/basic/functools_partial_lru.py`. Tests: `uv run --python 3.12 python3 tests/molt_diff.py /tmp/molt_update_wrapper_test.py`, `uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/functools_partial_lru.py`.
- 2026-01-14T15:40:13Z codex-7757: implementing full bitwise ops (xor/and/or/shifts/invert) across runtime/frontend/wasm and restoring deep nested loop bench; locked runtime/backend/frontend/bench files.
- 2026-01-14T15:47:11Z codex-7757: implemented unary invert (~) op across frontend/backend/runtime/wasm + WIT, restored XOR in deep loop bench, added differential coverage for bitwise int ops; test: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/bitwise_int.py`.
- 2026-01-14T15:48:46Z codex-7757: auditing list comprehension lowering + adding scope/order differential coverage; locked frontend and new listcomp test file.

- 2026-01-14T15:56:06Z codex-81190: implemented stdlib bisect shim (bisect_left/right + insort_left/right + key handling + error parity) with helper-bound handling to avoid delayed exceptions, added differential coverage, and updated README/ROADMAP/STATUS/0015. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/bisect_basic.py`.

- 2026-01-14T15:58:29Z codex-81190: starting heapq stdlib shim (heapify/heappush/heappop/heapreplace/heappushpop/nlargest/nsmallest) + differential coverage + docs updates.

- 2026-01-14T16:03:48Z codex-81190: implemented heapq shim (heapify/heappush/heappop/heapreplace/heappushpop/nlargest/nsmallest), matched CPython heap ordering by using right-child tie-break, added differential coverage, updated 0015/STATUS/README/ROADMAP, and exported heapq in stdlib. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/stdlib/heapq_basic.py`.
- 2026-01-14T16:12:57Z codex-64253: starting attr/dunder coverage pass (runtime attr lookup for class/type, __delattr__, hasattr exception handling, __class__/__dict__ exposure) + new differential test `tests/differential/basic/attr_dunder_access.py`. Locks: `runtime/molt-runtime/src/lib.rs`, `tests/differential/basic/attr_dunder_access.py`. Tests/bench pending.
- 2026-01-14T16:25:36Z codex-7757: updated AGENTS/GEMINI to forbid workaround/partial implementations when locks block progress (wait for lock to clear).
- 2026-01-14T16:33:11Z codex-64253: implemented class/type attr lookup hooks + __getattribute__/__getattr__ AttributeError fallback with guarded exception stack, added __delattr__ hooks for objects/dataclasses/types, exposed __class__/__dict__ for instances/functions/modules/classes, fixed hasattr/getattr-default to honor AttributeError even when __getattribute__ raises, and added `tests/differential/basic/attr_dunder_access.py`. Docs updated: `docs/spec/STATUS.md`, `docs/spec/0014_TYPE_COVERAGE_MATRIX.md`. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/attr_dunder_access.py`.
- 2026-01-14T16:44:48Z codex-7757: added module name lookup runtime op (NameError semantics) + wasm import/harness, updated frontend to use MODULE_GET_NAME for global name loads, and fixed listcomp scoping/NameError parity; test: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/listcomp_scope.py`.
- 2026-01-14T16:49:28Z codex-7757: added AGENTS/GEMINI guidance to avoid frontend-only hacks for runtime/compiler/backend semantics; compiled binaries must match CPython.
- 2026-01-14T16:54:16Z codex-64253: resuming attr/dunder pass to restore rigorous test and fix __delattr__/struct-field semantics plus frontend setattr lowering; locks: `runtime/molt-runtime/src/lib.rs`, `src/molt/frontend/__init__.py`, `tests/differential/basic/attr_dunder_access.py`.
- 2026-01-14T17:07:39Z codex-64253: fixed hasattr fast-path (no constant True for struct fields), added class __setattr__ override guard in guarded setattr lowering, initialized struct fields to pending, populated instance __dict__ from struct fields, and made attr lookup favor dict when present; default __delattr__ now clears struct field + dict. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/attr_dunder_access.py`, `... attr_hooks.py`, `... getattribute_basic.py`.
- 2026-01-14T17:09:15Z codex-64253: updated CHECKPOINT and cleared AGENT_LOCKS after attr/dunder pass; no additional tests run.

- 2026-01-14T17:21:37Z codex-81190: wiring heapq runtime fast paths (runtime exports + frontend builtins + wasm intrinsics) and updating heapq shim to use them; add docs/test updates as needed.

- 2026-01-14T17:30:27Z codex-7838: starting molt CLI and install-story pass (cli commands + docs).
- 2026-01-14T17:38:29Z codex-81190: wired heapq runtime fast paths (molt_runtime exports + WIT/wasm imports + builtin table mapping + frontend builtins) and updated heapq shim to use list-only fast path fallback; tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/stdlib/heapq_basic.py`.
- 2026-01-14T17:44:04Z codex-81190: starting stdlib feature push for heapq full surface, itertools core iterators, collections deque/defaultdict/Counter parity, and functools cmp_to_key/total_ordering; will add differential coverage and update 0015/STATUS/ROADMAP.

- 2026-01-14T17:44:20Z codex-7838: updated CLI build (uv.lock enforcement, --output, JSON/verbose), adjusted native tests for per-script output naming, added --output hello_molt in bench/profile tools, and refreshed README/spec docs for install story and deps/vendor status; tests not run. Noted AGENT_LOCKS now missing prior codex-81190 entries (unexpected).

- 2026-01-14T17:47:36Z codex-7838: AGENT_LOCKS updated during work; codex-81190 locks now present again.

- 2026-01-14T17:52:26Z codex-7838: starting CLI expansion (run/test/diff/bench/profile/lint/doctor/package/publish/verify) and install tooling updates; touching cli + docs (avoid locked STATUS/ROADMAP).

- 2026-01-14T18:00:31Z codex-7838: implemented CLI commands (run/test/diff/bench/profile/lint/doctor/package/publish/verify) with wrappers + package/verify scaffolding; updated README and specs 0012/0013; no tests run. Avoided locked STATUS/ROADMAP updates.

- 2026-01-14T18:02:28Z codex-7838: requesting codex-81190 to release or transfer locks on docs/spec/STATUS.md and ROADMAP.md so CLI command status updates can land.

- 2026-01-14T18:09:44Z codex-7838: user approved lock override; removing locks for docs/spec/STATUS.md and ROADMAP.md to update CLI command status.

- 2026-01-14T18:14:50Z codex-7838: implementing CLI determinism/capabilities flags, cross-target builds, vendor materialization, package hardening, and config defaults; locking cli + molt-backend sources.

- 2026-01-14T19:08:52Z codex-81190: refactored `collections` deque to use slicing (no list method lookups), rewired Counter/defaultdict to internal dict storage with custom mapping methods, added binary-op dunder fallback for `__add__`/`__sub__`/`__or__`/`__and__` in runtime, and tightened frontend layout guards for module-qualified class refs + dict-subclass dynamic fallback. Updated STATUS + stdlib matrix notes for eager itertools/heapq + binary-op fallback. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py /tmp/add_class.py`, `... /tmp/counter_add.py`, `... /tmp/counter_values.py`; `tests/differential/stdlib/collections_deque.py` blocked by `src/molt/cli.py` SyntaxError (escaped quote).
- 2026-01-14T19:16:20Z codex-81190: added Counter items view iterator + defaultdict list/dict factory fast paths; `collections_deque` differential now passes; `functools_more` blocked by unsupported class decorators. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py /tmp/defaultdict_debug.py` (pass), `... tests/differential/stdlib/collections_deque.py` (pass), `... tests/differential/stdlib/functools_more.py` (fails: unsupported class decorator).

- 2026-01-14T18:26:58Z codex-7838: implemented determinism/capabilities flags, cross-target build support (Cranelift target + zig link), vendor materialization, package/verify hardening, config defaults, and run --compiled; updated STATUS/ROADMAP/specs/README; no tests run.
- 2026-01-14T18:33:31Z codex-7838 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): added CLI smoke tests, documented inline TODO requirement in AGENTS/GEMINI, and inserted TODO markers for partial tooling paths in the CLI; installed zig via brew for cross-linking support. Tests: `PYTHONPATH=src uv run --python 3.12 python3 -m pytest -q tests/cli/test_cli_smoke.py`.
- 2026-01-14T18:42:20Z codex-7838 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): added zig target query mapping for darwin/linux triples and suppressed backend stdout in JSON mode; added cross-target CLI build smoke test. Tests: `PYTHONPATH=src uv run --python 3.12 python3 -m pytest -q tests/cli/test_cli_smoke.py`.
- 2026-01-14T18:44:34Z codex-7838 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): starting CLI improvements pass (JSON schema/no-stdout, clean/cache, cross-target rustup helpers, vendor markers/extras resolution, shell completions, compiled argv passthrough gating + capability profiles). Locks: `src/molt/cli.py`, `tests/cli/test_cli_smoke.py`. Tests pending.
- 2026-01-14T19:10:31Z codex-7838 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): implemented CLI JSON schema, cache/clean/completion commands, rustup target bootstrapping + zig target normalization, vendor marker/extras filtering, capability profile parsing/validation, and compiled-argv gating; updated CLI docs + README and added completion smoke test. Tests: `PYTHONPATH=src uv run --python 3.12 python3 -m pytest -q tests/cli/test_cli_smoke.py`.
- 2026-01-14T19:48:53Z codex-81190: added for/async-for else lowering with break tracking, fixed async for-else flag storage across awaits, updated class/function/local boxing for nested defs, and added `tests/differential/basic/for_else.py` + expanded `async_for_else.py`; fixed callargs_new capacity bug in class init, updated `_collect_assigned_names` to include function/class defs, and rewrote `functools.cmp_to_key` to avoid nested class scope issues (module-level _CmpKey + key factory). Docs: STATUS updated for class decorators + for-else. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/for_else.py`, `... tests/differential/basic/async_for_else.py`, `... tests/differential/stdlib/functools_more.py`.
- 2026-01-14T20:39:51Z codex-48400: starting formalize skill creation; inspecting CLI/tools/tests/bench/docs to author `formalize` skill in `~/.codex/skills/formalize`.
- 2026-01-14T20:44:26Z codex-48400: created `formalize` skill (workflow + tooling references) and packaged to `/Users/adpena/.codex/skills/formalize.skill` using a temporary `/tmp/skillenv` with PyYAML. Tests: none.

- 2026-01-14T20:58:12Z codex-81190: starting list method parity pass (dynamic call binding for list.pop/index, list.index start/stop) + doc/test updates as needed.
- 2026-01-14T21:10:48Z codex-69357 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): implemented fnmatch escape semantics (literal []/[[/[]], invalid range handling) with dict-backed char classes for Molt compatibility; added differential coverage and updated stdlib matrix. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/stdlib/fnmatch_basic.py`.

- 2026-01-14T21:11:50Z codex-81190: fixed list.pop/index dynamic binding by routing list.index to range, adding list pop/index binders, and falling back to call_bind for bound-method arity mismatches in Cranelift + WASM backends; added list.index start/stop + dynamic pop/index coverage to tests/differential/basic/list_dict.py. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/list_dict.py` (pass after `PYTHONPATH=src python3 -m molt.cli clean --cache --no-artifacts`).
- 2026-01-14T21:13:40Z codex-69357: starting CLI pass for build caching/flags docs + STATUS update for fnmatch semantics; locking `src/molt/cli.py`, `docs/spec/0012_MOLT_COMMANDS.md`, `docs/spec/STATUS.md`.
- 2026-01-14T21:18:28Z codex-69357: added verbose cache hit/miss reporting for `molt build`, clarified build cache behavior in `docs/spec/0012_MOLT_COMMANDS.md`, and updated STATUS with fnmatch literal bracket escape note. Tests: not run.
- 2026-01-14T21:37:11Z codex-69357: added CLI roadmap plan in ROADMAP; extended `molt build` with cache/report/dir/out-dir/emit/emit-ir/profile/rebuild flags + `molt config` command + compiled run rebuild handling and out-dir resolution; updated STATUS and 0012 CLI spec. Tests: not run.
- 2026-01-14T21:53:57Z codex-81190: completed str method parity pass (find/count/startswith/endswith ranges, split maxsplit, replace count, strip chars, join iterable + error parity), fixed bytes whitespace split maxsplit remainder handling, and relaxed frontend fast paths to fall back for keywords/extra args; added differential coverage in `tests/differential/basic/str_methods.py` and updated STATUS/0014 matrices. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/str_methods.py`.
- 2026-01-14T22:06:54Z codex-81190: starting parity audit + fixes for list/dict/str dunders and Counter behavior, plus bytes/bytearray slice-aware find/startswith/endswith, with differential coverage updates and spec matrix/status sync.

- 2026-01-14T22:36:57Z codex-81190: starting class decorator lowering + verify/strengthen for-else lowering + fix runtime __eq__ dispatch for Counter parity + audit touched files for robustness/tests.
- 2026-01-15T02:35:46Z codex-81190: fixed async `anext(..., default)` and async-for termination by routing through `molt_anext_builtin` with missing/default sentinel handling; simplified `_emit_await_anext` to await the builtin future; adjusted function/class decorator lowering to evaluate decorator expressions before function/class creation and apply afterward (no early binding). Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/async_anext_default_future.py`, `... async_for_iter.py`, `... async_for_else.py`, `... for_else.py`, `... class_decorators.py`, `... generator_decorators.py`, `... functools_more.py`.
- 2026-01-15T06:05:51Z codex-69357: fixed named exception matching by adding `molt_string_eq` runtime op, wiring `STRING_EQ` in frontend/backend, and using it in exception handler matching to avoid pending-exception interference. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/attr_hooks.py`, `... tests/differential/basic/class_decorators.py`, `... tests/differential/basic/container_dunders.py`.

- 2026-01-15T06:12:02Z codex-69357: starting formalize run (lint/tests/benches/fuzz/Miri + commit/push/CI); will update bench results, README perf summary, logs/, CHECKPOINT.
- 2026-01-15T19:15:07Z codex-69357: lowered bytes/bytearray count/startswith/endswith to ops and added runtime exports for startswith/endswith/count (slice variants), aligning wasm/native behavior; tweaked STATUS fnmatch note formatting. Tests: `uv run --python 3.12 pytest -q tests/test_wasm_bytes_ops.py::test_wasm_bytes_ops_parity`.
- 2026-01-15T19:20:14Z codex-69357: added TODO markers for missing print keyword support, list.index keyword args, and start/end for find/startswith/endswith; flagged wasm string_count_slice stub and native memoryview.cast gap. Tests: none.
- 2026-01-15T19:30:12Z codex-6819: strengthened AGENTS/GEMINI hard-stop language for TODOs on partial/stubbed behavior and forbidding test weakening to hide gaps. Tests: none.
- 2026-01-15T19:31:31Z codex-6819: mirrored hard-stop TODO/test-masking rules into CONTRIBUTING docs. Tests: none.
- 2026-01-15T19:37:10Z codex-6819: reviewed SECURITY.md and MATRIX docs (non-compatibility) for accuracy; noted mismatches for C API matrix, syntax matrix async/decorators, type coverage builtins, and semantic GC/recursionlimit notes. Tests: none.
- 2026-01-15T19:41:43Z codex-6819: updated SECURITY.md and MATRIX specs (0212/0021/0014/0023) to fix accuracy mismatches; added explicit C API missing note and aligned async/decorator/builtin/GC entries. Tests: none.
- 2026-01-15T19:45:42Z codex-6819: aligned README and STATUS with current async/format/memoryview/reflection behavior and documented missing C API surface. Tests: none.
- 2026-01-15T19:47:49Z codex-6819: checked `docs/spec/STATUS.md` against 0014/0023 matrices for drift; no direct contradictions found (STATUS currently locked for edits). Tests: none.
- 2026-01-15T19:49:12Z codex-6819: updated STATUS with explicit cross-references for hashing/GC and pointed exception coverage to 0014 matrix; released STATUS lock. Tests: none.
- 2026-01-15T19:54:18Z codex-6819: cross-scanned STATUS vs 0015/0019; added contextlib to stdlib coverage list and clarified opcode matrix notes for with/async/async generators. Tests: none.
- 2026-01-15T19:56:49Z codex-6819: added STATUS limitation for eager itertools product/permutations/combinations with TODO for lazy streaming parity. Tests: none.
- 2026-01-15T20:00:43Z codex-6819: expanded itertools differential coverage (repeat/r edge cases, groupby/tee interleaving) and added operator basic/edge coverage. Tests: none.
- 2026-01-15T20:05:06Z codex-6819: strengthened str/bytes/list/dict differential tests with negative indices, tuple prefixes, empty separators, and dict method coverage. Tests: none.
- 2026-01-15T20:09:14Z codex-6819: added container dunder precedence/fallback cases, generator throw/close on unstarted generators, nested yield-from StopIteration values, and deque rotate/index/insert edge coverage. Tests: none.
- 2026-01-15T20:12:57Z codex-6819: added planned import-only stdlib modules to the compatibility matrix and reflected planned status in STATUS/ROADMAP. Tests: none.
- 2026-01-15T20:14:13Z codex-6819: adjusted STATUS/ROADMAP wording to keep new stdlib modules listed as planned (not current stubs). Tests: none.
- 2026-01-15T20:17:25Z codex-6819: expanded stdlib matrix and STATUS/ROADMAP planned import-only lists with http/urllib/email/logging/cgi modules. Tests: none.
- 2026-01-15T20:19:40Z codex-6819: added roadmap TODOs for syntax/opcode/semantics/C-API gaps with explicit status/priority/tier metadata. Tests: none.
- 2026-01-15T19:50:27Z codex-69357: implemented native memoryview.cast + multi-d indexing/slice assignment support and wasm string_count_slice parity; added wasm/native coverage for string count slice + memoryview cast/indexing. Tests: `uv run --python 3.12 pytest -q tests/test_wasm_string_ops.py::test_wasm_string_ops_parity`, `uv run --python 3.12 pytest -q tests/test_native_memoryview.py::test_native_memoryview_build_and_run`.
- 2026-01-15T19:54:53Z codex-69357: expanded container dunder differential coverage for dict/list/str (empty cases, extra __contains__ cases, unhashable key handling) in `tests/differential/basic/container_dunders.py`. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/container_dunders.py`.
- 2026-01-15T20:04:31Z codex-69357: hardened CALL_METHOD lowering to route through callargs+call_bind in native/wasm backends; expanded getattr call differential coverage (list/dict/str + bound method defaults). Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/getattr_calls.py`.
- 2026-01-15T20:22:21Z codex-69357: restored getattr `str.replace` coverage, added descriptor edge cases (non-callable __get__, classmethod/staticmethod mix), recorded method default specs for class methods, exposed str.replace as a method, and ensured attr lookup preserves descriptor exceptions. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/getattr_calls.py`.
- 2026-01-15T20:24:47Z codex-6819: starting TODO metadata sweep for pending/partial items in ROADMAP/STATUS/spec matrices; sync status legend as needed.
- 2026-01-15T20:29:43Z codex-69357 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): formalize run in progress; `tools/dev.py lint` fixed via `uv run --python 3.12 ruff format .` (3 files), `tools/dev.py test` failing with multiple missing-feature mismatches (async for-else, attr hooks, bool print, bytes find ranges, list/dict gaps, generator semantics, for-else lowering, free vars/comprehensions) and unsupported isinstance args in collections. Tests: `tools/dev.py lint`, `uv run --python 3.12 ruff format .`, `tools/dev.py test` (failed).
- 2026-01-15T20:34:29Z codex-6819: added TODO tags for pending/partial items across STATUS/ROADMAP and spec matrices (0012/0013/0014/0019/0021/0023/0212) plus DB/accel specs (0700/0701/0912); no tests run.
- 2026-01-15T20:50:50Z codex-69357 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): added replace count support (str/bytes/bytearray) across frontend/runtime/backends/WIT and updated wasm stubs; added placeholder TODO for range-style count keyword args. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/attr_hooks.py` (pass), `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/str_methods.py` (failed: find start/end unsupported).
- 2026-01-15T21:11:16Z codex-69357 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): added builtin class method access for list/dict/str/bytes/bytearray/memoryview, membership fallback via `__contains__`/`__iter__`/`__getitem__`, expanded container dunder tests, getattr call coverage, and class decorator parity cases; updated STATUS/0014/ROADMAP. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/container_dunders.py`, `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/getattr_calls.py`, `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/class_decorators.py`.
- 2026-01-15T20:57:15Z codex-6819: normalized TODO taxonomy across docs/ROADMAP/specs/optimization plan; added dataframe milestone + TODO tags in design/vision/optimization specs and refreshed AGENTS/GEMINI/CONTRIBUTING TODO format guidance. Tests: none.
- 2026-01-15T21:20:13Z codex-6819: clarified async runtime docs to note custom molt-runtime scheduler (no tokio in core) and tokio usage limited to service crates; added decision note in runtime spec and STATUS async notes. Tests: none.
- 2026-01-15T21:21:41Z codex-6819: added roadmap item for native-only tokio host adapter with determinism guard + capability gating. Tests: none.
- 2026-01-15T21:15:17Z codex-69357: starting slice-aware find/startswith/endswith parity for str/bytes/bytearray (frontend+runtime+backends+tests) to resolve str_methods range gaps.
- 2026-01-15T22:00:15Z codex-69357: added slice-aware find/startswith/endswith for str/bytes/bytearray (tuple prefixes + int needles for bytes find), standardized slice index handling (None + CPython errors), updated frontend/backends/WIT/wasm harness and wasm tests; documented split maxsplit TODO in STATUS/0014/ROADMAP. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/str_methods.py` (failed: split maxsplit unsupported), `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/bytes_ranges.py`, `uv run --python 3.12 pytest -q tests/test_wasm_string_ops.py::test_wasm_string_ops_parity`, `uv run --python 3.12 pytest -q tests/test_wasm_bytes_ops.py::test_wasm_bytes_ops_parity`.
- 2026-01-15T22:03:20Z codex-69357: starting split maxsplit support for str/bytes/bytearray (frontend/runtime/backends/wasm harness/tests) to clear str_methods failure.
- 2026-01-15T22:25:55Z codex-69357: wired split maxsplit ops in backend/wasm/WIT and implemented wasm harness split helpers + baseImports for str/bytes/bytearray; documented strip(chars) gap in STATUS/ROADMAP and added frontend TODO. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/str_methods.py` (failed: strip(chars) unsupported).
- 2026-01-15T22:36:21Z codex-69357: added `str.strip(chars)` support across frontend/runtime/backends/WIT/wasm harness and updated STATUS/ROADMAP; noted join iterable gap from str_methods failure. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/str_methods.py` (failed: `str.join` expects list/tuple).
- 2026-01-15T22:44:51Z codex-69357: implemented `str.join` iterable support + CPython 3.12 error message parity for `str.find` non-str needle; updated STATUS/ROADMAP. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/str_methods.py`.
- 2026-01-15T22:49:06Z codex-69357: formalize run started; lint fixed via `uv run --python 3.12 ruff format .` then `tools/dev.py lint` passed; `tools/dev.py test` failed with multiple missing features/mismatches (unsupported isinstance args in `src/molt/stdlib/collections/__init__.py`, async_for_else mismatch, attr_dunder_access AttributeError, augassign bool display, unary op unsupported, for-else unsupported, functools allowlist `_CmpKey`, generator decorator/semantics/state gaps, list/dict fromkeys missing, listcomp scope, set.add dynamic, stress_structures sorting, starred assignment). Tests: `tools/dev.py lint`, `tools/dev.py test` (failed).
- 2026-01-15T22:55:14Z codex-69357: enabled module-declared class name resolution for `isinstance` by tracking module class names in the frontend; `collections_basic` now passes. `tools/dev.py test` still fails on async for-else, attr dunder access, bool print formatting, unary op, for-else unsupported, generator gaps, list/dict fromkeys, listcomp scope, set.add, stress_structures sort, starred assignment, collections_counter backend panic, stdlib allowlist signature mismatch, etc. Tests: `tools/dev.py test` (failed).
- 2026-01-15T23:02:42Z codex-69357: added async for-else break-flag lowering by tracking per-loop break flags, marking breaks, and gating async for orelse execution; loop bodies now push/pop break flag sentinels to isolate nested loops. Tests: `uv run --python 3.12 pytest -q tests/differential/basic/async_for_else.py` (no tests collected).
- 2026-01-15T23:03:53Z codex-69357: validated async for-else differential via `tests/molt_diff.py`. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/async_for_else.py` (pass).
- 2026-01-15T23:09:14Z codex-69357: audited pytest naming (no `def test_` in non-`test_*.py` files) and re-validated dynamic getattr call path coverage. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/getattr_calls.py` (pass).
- 2026-01-15T23:11:26Z codex-69357: ran `tools/dev.py test` (3.13/3.14/3.12) and differential suite; failures: attr_dunder_access (AttributeError fallback), augassign_inplace bool display, bitwise_int unsupported unary op, collections_counter backend panic, comprehensions/free_vars/listcomp_scope scope leakage, for_else unsupported, functools_partial_lru bool formatting, generator_decorators unsupported, generator_protocol/state mismatches, lambda missing list tail due to len(None), list_dict dict.fromkeys missing, memoryview_multidim compiler crash, repro_set_add_dynamic missing set.add, stdlib_allowlist_calls signature mismatch (itertools.chain), stress_structures sorting/type compare + set.add, unpack_assignment starred unsupported. Tests: `tools/dev.py test` (failed).
- 2026-01-15T23:36:56Z codex-69357: fixed attr/dunder parity: __getattribute__/__getattr__ fallback handling with exception stack, __delattr__ dispatch, __dict__/__class__ handling for objects/types/dataclasses, function __annotations__/__dict__ support, and marked classes with custom attr hooks as dynamic. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/attr_dunder_access.py` (pass).
- 2026-01-15T23:39:14Z codex-69357: reran `tools/dev.py test` after attr/dunder fixes; pytest suites still pass, differential suite failures now limited to bool formatting, unary op, collections_counter backend panic, comprehensions/free vars/listcomp_scope, for-else, generators, lambda len(None), dict.fromkeys, memoryview_multidim crash, set.add + sorting, stdlib allowlist signature mismatch, starred assignment. Tests: `tools/dev.py test` (failed).
- 2026-01-15T23:42:43Z codex-69357: starting pytest naming audit for tests/ (file naming + def test_ scanning) and will fix any mismatches.
- 2026-01-15T23:47:17Z codex-69357: fixed bool formatting for default f-string formatting by routing bool through string formatting in format_with_spec and checking bool before int in print; audited pytest naming (no test defs in non-test files; empty compliance test_spec placeholders remain). Tests: PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/augassign_inplace.py, PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/functools_partial_lru.py.
- 2026-01-15T23:49:55Z codex-69357: starting unary-op parity work for bitwise_int differential (frontend lowering + runtime ops as needed).
- 2026-01-15T23:54:25Z codex-69357: added unary invert lowering to INVERT op and implemented runtime molt_invert for int/bool/bigint with CPython-style TypeError; bitwise_int differential now passes. Tests: PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/bitwise_int.py.
- 2026-01-16T00:05:24Z codex-69357: implemented sync for-else/while-else lowering with break flags (loop break tracking + orelse emission) and wired loop helpers to pass break flags; for_else differential now passes. Tests: PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/for_else.py.
- 2026-01-16T00:07:39Z codex-69357: starting generator protocol/state parity fixes (diff tests + frontend/runtime changes as needed).
- 2026-01-16T01:23:38Z codex-69357: fixed generator lifetime ownership by inc-refing closure args on alloc_generator (native+wasm), dec-refing generator payload slots on drop, and skipping close() execution for unstarted generators; generator_state/protocol differentials now pass. Tests: `PYTHONPATH=src uv run --python 3.12 python3 -m molt.cli clean --cache --no-artifacts`, `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/generator_state.py`, `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/generator_protocol.py`.
- 2026-01-16T01:26:03Z codex-69357: ran `uv run --python 3.12 python3 tools/dev.py test`; failure in `tests/test_native_async_protocol.py::test_native_async_protocol` (native async protocol output lines were `0.0` etc instead of 1/2/3/20/30/1/done/7). No fixes applied.
- 2026-01-16T02:00:16Z codex-69357: fixed async protocol by allowing closure load/store to accept raw poll pointers or boxed handles; updated CLI default build output dir to `/tmp` and adjusted native/wasm tests to use `/tmp`. Tests: `PYTHONPATH=src uv run --python 3.12 pytest -q tests/test_native_async_protocol.py::test_native_async_protocol`, `PYTHONPATH=src uv run --python 3.12 pytest -q tests/test_wasm_async_protocol.py::test_wasm_async_protocol_parity`.
- 2026-01-16T02:03:48Z codex-69357: ran `PYTHONPATH=src uv run --python 3.12 python3 tools/dev.py test`; failures in differential suite: `collections_counter.py` backend panic (molt_init_collections_counter attr missing), `generator_decorators.py` unsupported decorators, `list_dict.py` missing dict.fromkeys, `listcomp_scope.py` module attr missing, `memoryview_multidim.py` compiler crash (tuple literal), `repro_set_add_dynamic.py` set.add missing, `stdlib_allowlist_calls.py` backend signature mismatch (itertools.chain), `stress_structures_fail.py` set.add missing, `stress_structures_pass.py` object sort compare, `unpack_assignment.py` starred assignment unsupported.
- 2026-01-16T02:06:09Z codex-69357: starting formalize run (lint/tests/bench/fuzz/miri) with scope in runtime/src/tests; will update on completion.
- 2026-01-16T02:55:24Z codex-69357: added TODO(optimization) marker for dict.fromkeys capacity hint in runtime; cleared locks. Tests: not run.
- 2026-01-16T03:16:46Z codex-69357: added dynamic set/frozenset method binding for add/len/iter/contains/pop; fixed listcomp NameError via print arg handling; added slice literal lowering and tuple guard; expanded frozenset_basic coverage; disabled module attr deferral for comprehensions. Tests: PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/repro_set_add_dynamic.py, listcomp_scope.py, memoryview_multidim.py, frozenset_basic.py.
- 2026-01-16T04:38:35Z codex-69357: fixed coroutine call_bind to invoke async wrappers (no future allocation with wrapper fn), kept generator allocation path; mirrored removal of coroutine special-case in wasm harness. Tests: `python3 tests/molt_diff.py tests/differential/basic/async_closure_decorators.py`, `python3 tests/molt_diff.py tests/differential/basic/generator_decorators.py`, `python3 tests/molt_diff.py tests/differential/basic/asyncio_future_basic.py`.
- 2026-01-16T05:33:39Z codex-69357 (git 7d31c358d57c5e95197f04e793c200d06e47adb5; dirty): added tuple concat in `molt_add`, added exception guards in `molt_add`/`molt_index`, switched set/frozenset iteration + printing to hash-table order, aligned int hash with CPython (-1 -> -2), and special-cased builtin `str()` for 0/1 args with TODO for encoding args; updated STATUS/0014/ROADMAP. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/recursion_limit.py`, `... stress_structures_fail.py` (still failing due to set order for strings), `... stress_structures_pass.py`, `... unpack_assignment.py`.
- 2026-01-16T05:52:06Z codex-69357: starting CPython hash parity work (SipHash13 + PYTHONHASHSEED) for strings/bytes/sets with deterministic test harness.
- 2026-01-16T06:11:39Z codex-69357: implemented SipHash13 + `PYTHONHASHSEED` hash parity for str/bytes/ints/floats/tuples, set deterministic diff env, added frozenset hash parity TODO, and updated STATUS/0014/0023/README/ROADMAP; added getrandom dependency (wasm/js + native). Tests: `cargo build --package molt-runtime` (warns on pre-existing unused assignment), `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/stress_structures_fail.py`, `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/stress_structures_pass.py`.
- 2026-01-16T06:23:58Z codex-69357: implemented CPython frozenset hash mixing (`shuffle_bits`, parity correction) and removed doc TODOs. Tests: `cargo build --package molt-runtime` (warns on pre-existing unused assignment), `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/frozenset_basic.py`, `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/stress_structures_fail.py`.
- 2026-01-16T06:26:52Z codex-69357: ran `tools/dev.py test` (3.13/3.14/3.12). Failures: `tests/differential/basic/builtin_iterators.py` mismatch and Molt exit -9 during the 3.12 differential suite; rest of the differential suite progressed after the failure until `verified_subset.py` exited non-zero. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tools/dev.py test` (failed).
- 2026-01-16T06:27:53Z codex-69357: starting builtin_iterators parity investigation (iterator TypeError cases / crash).
- 2026-01-16T06:46:11Z codex-69357: fixed iterator exception propagation by adding `_emit_iter_next_checked` with raise+exit on pending exceptions and wiring it into list/set/frozenset/dict fill/set update, for-loops, `next`, `yield from`, and async anext paths. Tests: `PYTHONPATH=src uv run --python 3.12 python3 tests/molt_diff.py tests/differential/basic/builtin_iterators.py`, `PYTHONPATH=src uv run --python 3.12 python3 tools/dev.py test` (all passed).
- 2026-01-16T07:35:32Z codex-69357: added `tools/bench_report.py` to combine native+WASM bench JSON into `docs/benchmarks/bench_summary.md`, generated the report, and documented the workflow in `AGENTS.md`, `GEMINI.md`, `docs/BENCHMARKING.md`, and `docs/spec/0008-benchmarking.md` (plus `docs/spec/BENCHMARKS.md`). Tests: `uv run --python 3.14 python3 tools/bench_report.py`, `uv run --python 3.12 ruff format tools/bench_report.py`.
- 2026-01-16T07:40:51Z codex-69357: extended `tools/bench_report.py` with `--update-readme` (README markers + summary derivation) and documented the flag in `AGENTS.md`, `GEMINI.md`, and the formalize skill. Generated updated bench summary + README block. Tests: `uv run --python 3.14 python3 tools/bench_report.py --update-readme`, `uv run --python 3.12 ruff format tools/bench_report.py`.
- 2026-01-16T07:44:25Z codex-69357: fixed bench_report formatting bug, refreshed summary output, and added gitignore rules for `*_molt` artifacts and `logs/`. Tests: `uv run --python 3.14 python3 tools/bench_report.py --update-readme`, `uv run --python 3.12 ruff format tools/bench_report.py`.
- 2026-01-16T07:46:51Z codex-69357: removed root `*_molt` artifacts and `logs/` directory to reduce repo clutter; left build caches intact. Tests: none (cleanup only).
