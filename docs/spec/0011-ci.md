# Molt CI Plan (GitHub Actions)

## 1. Pipeline Overview
Molt uses a unified GitHub Actions pipeline for both the Python compiler and the Rust runtime.

## 2. Jobs

### 2.1 Python (Compiler & Tooling)
- **Environment**: `ubuntu-latest` and `macos-latest`.
- **Steps**:
    - Install `uv`.
    - `uv sync --frozen`.
    - `ruff check .` (Linting).
    - `mypy src` (Static typing).
    - `pytest tests/compiler` (Unit tests).

### 2.2 Rust (Runtime & Core)
- **Environment**: `ubuntu-latest` and `macos-latest`.
- **Steps**:
    - Install `rustup` with `wasm32-wasip1` target.
    - `cargo fmt --check`.
    - `cargo clippy -- -D warnings`.
    - `cargo test`.
    - `cargo audit` (Security scanning).

### 2.3 Integration & Differential
- **Steps**:
    - Build the Molt CLI.
    - Run the `molt-diff` suite against CPython 3.12.

### 2.4 Performance & Artifacts
- **Steps**:
    - Run `molt bench`.
    - Upload benchmark results as comments on PRs.
    - Build and upload release binaries for macOS (arm64) and Linux (x86_64, arm64).

## 3. Caching Strategy
- **Python**: Cache `~/.cache/uv`.
- **Rust**: Cache `target/` and `~/.cargo/registry` using `swatinem/rust-cache`.
- **WASM**: Cache pre-compiled Molt Packages.

## 4. Release Trigger
- Tagging a version (`vX.Y.Z`) triggers a full release build with signed binaries and SBOM generation.
